Bridge.assembly("UntappdDataAnalyzer.Bridge",function(){"use strict";Bridge.define("UntappdDataAnalyzer.Bridge.App",{main:function(){var $t,divContainer,row,col,formGroup,input,small,button;UntappdDataAnalyzer.Bridge.App.AddJquery(document.head);UntappdDataAnalyzer.Bridge.App.AddBootstrap(document.head);UntappdDataAnalyzer.Bridge.App.AddHighcharts(document.head);UntappdDataAnalyzer.Bridge.App.AddChartsRender(document.head);divContainer=($t=document.createElement("div"),$t.className="container-fluid",$t);document.body.appendChild(divContainer);UntappdDataAnalyzer.Bridge.App.AddDivAsRow(divContainer,"medianRatingByCountry");UntappdDataAnalyzer.Bridge.App.AddDivAsRow(divContainer,"countByCountry");UntappdDataAnalyzer.Bridge.App.AddDivAsRow(divContainer,"medianRatingByBrewery");UntappdDataAnalyzer.Bridge.App.AddDivAsRow(divContainer,"countByBrewery");UntappdDataAnalyzer.Bridge.App.AddDivAsRow(divContainer,"medianRatingByStyle");UntappdDataAnalyzer.Bridge.App.AddDivAsRow(divContainer,"countByStyle");row=($t=document.createElement("div"),$t.className="row",$t);divContainer.appendChild(row);col=($t=document.createElement("div"),$t.className="mx-auto",$t);row.appendChild(col);formGroup=($t=document.createElement("div"),$t.className="form-group",$t);col.appendChild(formGroup);input=($t=document.createElement("input"),$t.type="file",$t.accept=".json",$t);formGroup.appendChild(input);small=function(_o1){return _o1.classList.add("form-text"),_o1.classList.add("text-muted"),_o1}(document.createElement("small"));formGroup.appendChild(small);button=function(_o2){return _o2.innerHTML="Process",_o2.classList.add("btn"),_o2.classList.add("btn-primary"),_o2.onclick=function(){if(input.files.length>0&&input.files[0]!=null){var reader=new FileReader;reader.onload=function(){var rawDataString=reader.result.toString(),data=Newtonsoft.Json.JsonConvert.DeserializeObject(rawDataString,System.Collections.Generic.IList$1(UntappdDataAnalyzer.Core.Models.Checkin)),dataAnalyzer=new UntappdDataAnalyzer.Core.Services.DataAnalyzer,statsByCountry=dataAnalyzer.GetStatisticsForNullableDoubleValues(Bridge.global.UntappdDataAnalyzer.Core.Models.Checkin,System.String,data,function(checkin){return checkin.BreweryCountry},function(checkin){return checkin.RatingScore}),statsByBrewery=dataAnalyzer.GetStatisticsForNullableDoubleValues(Bridge.global.UntappdDataAnalyzer.Core.Models.Checkin,System.String,data,function(checkin){return checkin.BreweryName},function(checkin){return checkin.RatingScore}),statsByStyle=dataAnalyzer.GetStatisticsForNullableDoubleValues(Bridge.global.UntappdDataAnalyzer.Core.Models.Checkin,System.String,data,function(checkin){return checkin.BeerType},function(checkin){return checkin.RatingScore}),medianRatingByCountry=System.Linq.Enumerable.from(statsByCountry).orderByDescending(function(item){return item.Median}).select(function(item){return{name:item.Key,y:item.Median}}).toList(System.Object),countByCountry=System.Linq.Enumerable.from(statsByCountry).orderByDescending(function(item){return item.Count}).select(function(item){return{name:item.Key,y:item.Count}}).toList(System.Object),medianRatingByBrewery=System.Linq.Enumerable.from(statsByBrewery).orderByDescending(function(item){return item.Median}).select(function(item){return{name:item.Key,y:item.Median}}).toList(System.Object),countByBrewery=System.Linq.Enumerable.from(statsByBrewery).orderByDescending(function(item){return item.Count}).select(function(item){return{name:item.Key,y:item.Count}}).toList(System.Object),medianRatingByStyle=System.Linq.Enumerable.from(statsByStyle).orderByDescending(function(item){return item.Median}).select(function(item){return{name:item.Key,y:item.Median}}).toList(System.Object),countByStyle=System.Linq.Enumerable.from(statsByStyle).orderByDescending(function(item){return item.Count}).select(function(item){return{name:item.Key,y:item.Count}}).toList(System.Object);renderRatingAndCountColumnChart("medianRatingByCountry","countByCountry",medianRatingByCountry.toArray(),countByCountry.toArray());renderAsPieChart("countByCountry",countByCountry.toArray());renderRatingAndCountColumnChart("medianRatingByBrewery","countByBrewery",medianRatingByBrewery.toArray(),countByBrewery.toArray());renderAsPieChart("countByBrewery",countByBrewery.toArray());renderRatingAndCountColumnChart("medianRatingByStyle","countByStyle",medianRatingByStyle.toArray(),countByStyle.toArray());renderAsPieChart("countByStyle",countByStyle.toArray())};reader.readAsText(input.files[0])}},_o2}(document.createElement("button"));col.appendChild(button)},statics:{methods:{AddJquery:function(head){var $t,scriptJquery=($t=document.createElement("script"),$t.src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js",$t.crossOrigin="anonymous",$t);scriptJquery.setAttribute("integrity","sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=");head.appendChild(scriptJquery)},AddHighcharts:function(head){var $t,scriptHighcharts=($t=document.createElement("script"),$t.src="https://cdnjs.cloudflare.com/ajax/libs/highcharts/6.0.7/highcharts.js",$t.crossOrigin="anonymous",$t);scriptHighcharts.setAttribute("integrity","sha256-F0xKYvUdYPCgKKgKGtEjxwHXKSRbwKP+2mOlgGoR0Fs=");head.appendChild(scriptHighcharts)},AddBootstrap:function(head){var $t,scriptBootstrap=($t=document.createElement("script"),$t.src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js",$t.crossOrigin="anonymous",$t),linkBootstrap;scriptBootstrap.setAttribute("integrity","sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl");head.appendChild(scriptBootstrap);linkBootstrap=($t=document.createElement("link"),$t.href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css",$t.rel="stylesheet",$t);linkBootstrap.setAttribute("integrity","sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm");linkBootstrap.setAttribute("crossorigin","anonymous");head.appendChild(linkBootstrap)},AddChartsRender:function(head){var $t,scriptChartsRender=($t=document.createElement("script"),$t.src="ChartsRender.js",$t);head.appendChild(scriptChartsRender)},AddDivAsRow:function(container,divId){var $t,row=($t=document.createElement("div"),$t.className="row",$t),div=($t=document.createElement("div"),$t.id=divId,$t.className="col-md",$t);row.appendChild(div);container.appendChild(row)}}}});Bridge.define("UntappdDataAnalyzer.Core.Extensions.LinqStatistics",{statics:{methods:{Median$1:function(source){if(source==null)throw new System.ArgumentNullException("source");var sortedList=System.Linq.Enumerable.from(source).orderBy(function(number){return number}).select(function(number){return number}).toList(System.Double),count=sortedList.Count,itemIndex=Bridge.Int.div(count,2)|0;return count%2==0?(sortedList.getItem(itemIndex)+sortedList.getItem(itemIndex-1|0))/2:sortedList.getItem(itemIndex)},Median:function(source){if(source==null)throw new System.ArgumentNullException("source");var sortedList=System.Linq.Enumerable.from(source).orderBy(function(number){return number}).select(function(number){return number}).toList(System.Double),count=sortedList.Count,itemIndex=Bridge.Int.div(count,2)|0;return count%2==0?(sortedList.getItem(itemIndex)+sortedList.getItem(itemIndex-1|0))/2:sortedList.getItem(itemIndex)}}}});Bridge.define("UntappdDataAnalyzer.Core.Models.Checkin",{fields:{BeerName:null,BreweryName:null,BeerType:null,BeerAbv:null,BeerIbu:null,Comment:null,VenueName:null,VenueCity:null,VenueState:null,VenueCountry:null,VenueLat:null,VenueLng:null,RatingScore:null,CreatedAt:null,CheckinUrl:null,BeerUrl:null,BreweryUrl:null,BreweryCountry:null,BreweryCity:null,BreweryState:null,FlavorProfiles:null,PurchaseVenue:null,ServingType:null},ctors:{init:function(){this.CreatedAt=System.DateTime.getDefaultValue()}}});Bridge.define("UntappdDataAnalyzer.Core.Models.DataItem$2",function(TKey){return{fields:{Key:Bridge.getDefaultValue(TKey),Values:null,Count:0,Average:0,Median:0}}});Bridge.define("UntappdDataAnalyzer.Core.Services.DataAnalyzer",{methods:{GetStatisticsForNullableDoubleValues:function(TModel,TKey,data,keySelector,valueSelector){var averageSelector=function(values){return System.Linq.Enumerable.from(values).where(function(v){return System.Nullable.hasValue(v)}).average(function(v){return System.Nullable.getValue(v)})},medianSelector=function(values){return UntappdDataAnalyzer.Core.Extensions.LinqStatistics.Median(System.Linq.Enumerable.from(values).where(function(v){return System.Nullable.hasValue(v)}).select(function(v){return System.Nullable.getValue(v)}))};return this.GetStatistics(TModel,TKey,System.Nullable$1(System.Double),data,keySelector,valueSelector,averageSelector,medianSelector)},GetStatisticsForNullableIntValues:function(TModel,TKey,data,keySelector,valueSelector){var averageSelector=function(values){return System.Linq.Enumerable.from(values).where(function(v){return System.Nullable.hasValue(v)}).average(function(v){return System.Nullable.getValue(v)})},medianSelector=function(values){return UntappdDataAnalyzer.Core.Extensions.LinqStatistics.Median$1(System.Linq.Enumerable.from(values).where(function(v){return System.Nullable.hasValue(v)}).select(function(v){return System.Nullable.getValue(v)}))};return this.GetStatistics(TModel,TKey,System.Nullable$1(System.Int32),data,keySelector,valueSelector,averageSelector,medianSelector)},GetStatistics:function(TModel,TKey,TValue,data,keySelector,valueSelector,averageSelector,medianSelector){return System.Linq.Enumerable.from(data).groupBy(keySelector,valueSelector,function(key,values){return{Key:key,Values:System.Linq.Enumerable.from(values).toList(TValue)}}).select(function(group){var $t;return $t=new(UntappdDataAnalyzer.Core.Models.DataItem$2(TKey,TValue)),$t.Key=group.Key,$t.Values=group.Values,$t.Count=group.Values.Count,$t.Average=averageSelector(group.Values),$t.Median=medianSelector(group.Values),$t}).orderBy(function(grouping){return grouping.Key}).toList(UntappdDataAnalyzer.Core.Models.DataItem$2(TKey,TValue))}}})});